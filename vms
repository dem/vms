#!/bin/bash
set -euo pipefail

export LIBVIRT_DEFAULT_URI=qemu:///system

VMS_ROOT="$(cd "$(dirname "$0")" && pwd)"
source "$VMS_ROOT/lib/config.sh"
source "$VMS_ROOT/lib/common.sh"

cmd="${1:-help}"
shift || true

case "$cmd" in
    bootstrap) source "$VMS_ROOT/commands/bootstrap.sh" "$@" ;;
    create)    source "$VMS_ROOT/commands/create.sh" "$@" ;;
    clone)     source "$VMS_ROOT/commands/clone.sh" "$@" ;;
    start)     source "$VMS_ROOT/commands/start.sh" "$@" ;;
    stop)      source "$VMS_ROOT/commands/stop.sh" "$@" ;;
    kill)      source "$VMS_ROOT/commands/kill.sh" "$@" ;;
    console)   source "$VMS_ROOT/commands/console.sh" "$@" ;;
    viewer)    source "$VMS_ROOT/commands/viewer.sh" "$@" ;;
    list)      source "$VMS_ROOT/commands/list.sh" "$@" ;;
    destroy)   source "$VMS_ROOT/commands/destroy.sh" "$@" ;;
    ssh)       source "$VMS_ROOT/commands/ssh.sh" "$@" ;;
    help|--help|-h) usage ;;
    *) die "unknown command: $cmd" ;;
esac
